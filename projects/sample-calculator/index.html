<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Örneklem Büyüklüğü Hesaplayıcı</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                        card: {
                            DEFAULT: "hsl(var(--card))",
                            foreground: "hsl(var(--card-foreground))"
                        },
                        popover: {
                            DEFAULT: "hsl(var(--popover))",
                            foreground: "hsl(var(--popover-foreground))"
                        },
                        primary: {
                            DEFAULT: "hsl(221.2 83.2% 53.3%)",
                            foreground: "hsl(210 40% 98%)"
                        },
                        secondary: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)"
                        },
                        muted: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(215.4 16.3% 46.9%)"
                        },
                        accent: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)"
                        },
                        destructive: {
                            DEFAULT: "hsl(0 84.2% 60.2%)",
                            foreground: "hsl(210 40% 98%)"
                        },
                        border: "hsl(214.3 31.8% 91.4%)",
                        input: "hsl(214.3 31.8% 91.4%)",
                        ring: "hsl(221.2 83.2% 53.3%)",
                    },
                    borderRadius: {
                        lg: "0.5rem",
                        md: "calc(0.5rem - 2px)",
                        sm: "calc(0.5rem - 4px)",
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer base {
            :root {
                --background: 0 0% 100%;
                --foreground: 222.2 84% 4.9%;
                --card: 0 0% 100%;
                --card-foreground: 222.2 84% 4.9%;
                --popover: 0 0% 100%;
                --popover-foreground: 222.2 84% 4.9%;
                --primary: 221.2 83.2% 53.3%;
                --primary-foreground: 210 40% 98%;
                --secondary: 210 40% 96.1%;
                --secondary-foreground: 222.2 47.4% 11.2%;
                --muted: 210 40% 96.1%;
                --muted-foreground: 215.4 16.3% 46.9%;
                --accent: 210 40% 96.1%;
                --accent-foreground: 222.2 47.4% 11.2%;
                --destructive: 0 84.2% 60.2%;
                --destructive-foreground: 210 40% 98%;
                --border: 214.3 31.8% 91.4%;
                --input: 214.3 31.8% 91.4%;
                --ring: 221.2 83.2% 53.3%;
                --radius: 0.5rem;
            }
        }
        body {
            @apply bg-slate-50 text-foreground antialiased font-sans;
        }
    </style>
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="min-h-screen py-10 px-4">

    <div class="max-w-4xl mx-auto space-y-8">

        <!-- Back Link -->
        <a href="index.html"
            class="inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-4">
            <i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i>
            Ana Sayfaya Dön
        </a>

        <!-- Main Calculator Card -->
        <div class="rounded-lg border bg-card text-card-foreground shadow-sm w-full border-2 border-border/50">
            <div class="flex flex-col space-y-1.5 p-6 md:p-8 text-center">
                <h3 class="text-3xl md:text-4xl font-bold text-primary tracking-tight">Örneklem Büyüklüğü Hesaplayıcı
                </h3>
                <p class="text-sm text-muted-foreground mt-2">Çalışmanız veya anketiniz için gereken örneklem sayısını
                    belirleyin.</p>
            </div>
            <div class="p-6 md:p-8 pt-0">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
                    <div class="space-y-6">
                        <!-- Population Size -->
                        <div class="space-y-2">
                            <label for="populationSize"
                                class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">Popülasyon
                                Büyüklüğü (N)</label>
                            <input type="number" id="populationSize" placeholder="örn., 1000 (isteğe bağlı)"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm py-3">
                            <div class="flex items-start gap-2 pt-1">
                                <p class="text-xs text-muted-foreground leading-relaxed">Çalıştığınız grubun toplam
                                    büyüklüğü. Sonsuz bir popülasyon için boş bırakın.</p>
                            </div>
                        </div>

                        <!-- Confidence Level -->
                        <div class="space-y-2">
                            <label for="confidenceLevel" class="text-sm font-medium leading-none">Güven Düzeyi</label>
                            <div class="relative">
                                <select id="confidenceLevel"
                                    class="flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none py-3">
                                    <option value="90">90%</option>
                                    <option value="95" selected>95%</option>
                                    <option value="99">99%</option>
                                </select>
                                <i data-lucide="chevron-down"
                                    class="absolute right-3 top-3 h-4 w-4 opacity-50 pointer-events-none"></i>
                            </div>
                            <div class="flex items-start gap-2 pt-1">
                                <p class="text-xs text-muted-foreground leading-relaxed">Sonuçların popülasyonu
                                    yansıttığından ne kadar emin olmak istediğiniz.</p>
                            </div>
                        </div>

                        <!-- Margin of Error -->
                        <div class="space-y-2">
                            <label for="marginOfError" class="text-sm font-medium leading-none">Hata Payı (E) %</label>
                            <input type="number" id="marginOfError" value="5"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm py-3">
                            <div class="flex items-start gap-2 pt-1">
                                <p class="text-xs text-muted-foreground leading-relaxed">Sonuçlardaki kabul edilebilir
                                    hata miktarı.</p>
                            </div>
                        </div>

                        <!-- Expected Prevalence -->
                        <div class="space-y-2">
                            <label for="prevalence" class="text-sm font-medium leading-none">Beklenen Prevalans (P)
                                %</label>
                            <input type="number" id="prevalence" value="50"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm py-3">
                            <div class="flex items-start gap-2 pt-1">
                                <p class="text-xs text-muted-foreground leading-relaxed">Popülasyondaki özelliğin
                                    beklenen oranı. Emin değilseniz %50 kullanın.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div
                        class="bg-secondary rounded-lg flex flex-col items-center justify-center p-6 text-center h-full sticky top-8 min-h-[300px]">
                        <h2 class="text-lg font-semibold text-primary/90 mb-2">Gerekli Örneklem Büyüklüğü</h2>
                        <div id="resultValue" class="text-6xl font-bold text-gray-900 mb-4 transition-all">-</div>
                        <p id="resultText" class="text-muted-foreground px-4 text-sm">Sonucu görmek için çalışma
                            parametrelerinizi girin.</p>
                    </div>
                </div>

                <!-- Error Alert -->
                <div id="errorAlert"
                    class="hidden mt-8 relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive">
                    <i data-lucide="alert-circle" class="h-4 w-4"></i>
                    <h5 class="mb-1 font-medium leading-none tracking-tight">Geçersiz Girdi</h5>
                    <div id="errorMessage" class="text-sm [&_p]:leading-relaxed"></div>
                </div>

            </div>
            <div class="flex items-center p-6 md:p-8 pt-0 justify-center">
                <button id="calculateBtn"
                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-11 px-8 bg-blue-600 text-white hover:bg-blue-700 w-full md:w-auto font-bold py-3 shadow-lg">
                    Hesapla
                </button>
            </div>
        </div>

        <!-- Formulas Card -->
        <div class="rounded-lg border bg-card text-card-foreground shadow-sm w-full border-2 border-border/50">
            <div class="flex flex-col space-y-1.5 p-6">
                <h3 class="text-2xl font-bold text-primary">Hesaplama Formülleri</h3>
            </div>
            <div class="p-6 pt-0 space-y-8 text-base">
                <div class="space-y-2">
                    <h3 class="text-xl font-semibold text-primary/90">Sonsuz Popülasyon Formülü</h3>
                    <p class="text-muted-foreground">Popülasyon büyüklüğü bilinmediğinde veya çok büyük olduğunda.</p>
                    <div class="bg-secondary p-4 rounded-md text-center font-mono text-lg my-2">
                        n = (Z² * P * (1 - P)) / E²
                    </div>
                </div>
                <div class="shrink-0 bg-border h-[1px] w-full"></div>
                <div class="space-y-2">
                    <h3 class="text-xl font-semibold text-primary/90">Sonlu Popülasyon Düzeltme Formülü</h3>
                    <p class="text-muted-foreground">Popülasyon büyüklüğü bilindiğinde.</p>
                    <div class="bg-secondary p-4 rounded-md text-center font-mono text-lg my-2">
                        n<sub>düzeltilmiş</sub> = (n * N) / (n + (N - 1))
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Init Icons
        lucide.createIcons();

        // Constants
        const Z_SCORES = {
            "90": 1.645,
            "95": 1.96,
            "99": 2.576
        };

        // Elements
        const inputs = {
            populationSize: document.getElementById('populationSize'),
            confidenceLevel: document.getElementById('confidenceLevel'),
            marginOfError: document.getElementById('marginOfError'),
            prevalence: document.getElementById('prevalence')
        };
        const calculateBtn = document.getElementById('calculateBtn');
        const resultValue = document.getElementById('resultValue');
        const resultText = document.getElementById('resultText');
        const errorAlert = document.getElementById('errorAlert');
        const errorMessage = document.getElementById('errorMessage');

        // Calculation Logic
        function calculate() {
            const populationSizeStr = inputs.populationSize.value;
            const confidenceLevelStr = inputs.confidenceLevel.value;
            const marginOfErrorStr = inputs.marginOfError.value;
            const prevalenceStr = inputs.prevalence.value;

            const N_val = populationSizeStr ? parseInt(populationSizeStr, 10) : null;
            const E_val = marginOfErrorStr ? parseFloat(marginOfErrorStr) / 100 : 0;
            const P_val = prevalenceStr ? parseFloat(prevalenceStr) / 100 : 0;
            const Z_val = Z_SCORES[confidenceLevelStr];

            // Reset UI
            errorAlert.classList.add('hidden');
            resultValue.textContent = "-";
            resultText.textContent = "Sonucu görmek için çalışma parametrelerinizi girin.";

            // Validation
            let error = null;
            if (isNaN(E_val) || E_val <= 0 || E_val >= 1) {
                error = "Hata Payı %0 ile %100 arasında bir yüzde olmalıdır.";
            } else if (isNaN(P_val) || P_val < 0 || P_val > 1) {
                error = "Beklenen Prevalans %0 ile %100 arasında bir yüzde olmalıdır.";
            } else if (N_val !== null && (isNaN(N_val) || N_val <= 0)) {
                error = "Popülasyon Büyüklüğü pozitif bir sayı olmalıdır.";
            }

            if (error) {
                errorMessage.textContent = error;
                errorAlert.classList.remove('hidden');
                return;
            }

            // Calculation
            let n_infinite = (Z_val * Z_val * P_val * (1 - P_val)) / (E_val * E_val);
            let finalSampleSize;

            if (N_val) {
                const n_adjusted = (n_infinite * N_val) / (n_infinite + (N_val - 1));
                finalSampleSize = Math.ceil(n_adjusted);
                if (finalSampleSize > N_val) {
                    finalSampleSize = N_val;
                }
            } else {
                finalSampleSize = Math.ceil(n_infinite);
            }

            if (isNaN(finalSampleSize)) {
                errorMessage.textContent = "Örneklem büyüklüğü hesaplanamadı. Lütfen girdilerinizi kontrol edin.";
                errorAlert.classList.remove('hidden');
                return;
            }

            // Display Result
            resultValue.textContent = finalSampleSize.toLocaleString('tr-TR');

            if (N_val && finalSampleSize === N_val) {
                resultText.textContent = `Nüfusun tamamı olan ${N_val.toLocaleString('tr-TR')} örneklenmelidir.`;
            } else {
                resultText.textContent = "Örneklenmesi önerilen birey sayısı budur.";
            }
        }

        // Event Listeners
        calculateBtn.addEventListener('click', calculate);

        // Auto-calculate on changes (optional, mirroring React effect)
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', calculate);
        });

        // Initial Calculation
        calculate();

    </script>
</body>

</html>