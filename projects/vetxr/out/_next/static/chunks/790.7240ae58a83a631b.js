(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{560:function(t,e,i){(function(t,e,i){"use strict";function s(){return(s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}function o(t,e){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function n(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',h={MARKER_VISIBILITY:"marker-visibility",GOTO_MARKER_DONE:"goto-marker-done",LEAVE_MARKER:"leave-marker",OVER_MARKER:"over-marker",RENDER_MARKERS_LIST:"render-markers-list",SELECT_MARKER:"select-marker",SELECT_MARKER_LIST:"select-marker-list",UNSELECT_MARKER:"unselect-marker",HIDE_MARKERS:"hide-markers",SET_MARKERS:"set-markers",SHOW_MARKERS:"show-markers"},l={click:"click",hover:"hover"},p="http://www.w3.org/2000/svg",c="psvMarker",u="marker",g="markersList",f=i.utils.dasherize(c),v={image:"image",imageLayer:"imageLayer",html:"html",polygonPx:"polygonPx",polygonRad:"polygonRad",polylinePx:"polylinePx",polylineRad:"polylineRad",square:"square",rect:"rect",circle:"circle",ellipse:"ellipse",path:"path"},d=function(){function t(s,r){if(!s.id)throw new i.PSVError("missing marker id");if(this.psv=r,this.id=s.id,this.type=t.getType(s,!1),this.visible=!0,this.$el=null,this.config={},this.data=void 0,this.tooltip=null,this.props={dynamicSize:!1,anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,width:null,height:null,def:null},this.loader=null,this.is3d()&&(this.loader=new e.TextureLoader,this.psv.config.withCredentials&&this.loader.setWithCredentials(!0),this.psv.config.requestHeaders&&"object"==typeof this.psv.config.requestHeaders&&this.loader.setRequestHeader(this.psv.config.requestHeaders)),this.isNormal())this.$el=document.createElement("div");else if(this.isPolygon())this.$el=document.createElementNS(p,"polygon");else if(this.isPolyline())this.$el=document.createElementNS(p,"polyline");else if(this.isSvg()){var o="square"===this.type?"rect":this.type;this.$el=document.createElementNS(p,o)}this.is3d()||(this.$el.id="psv-marker-"+this.id,this.$el[c]=this),this.update(s)}var r=t.prototype;return r.destroy=function(){delete this.$el[c],delete this.$el,delete this.config,delete this.props,delete this.psv},r.is3d=function(){return this.type===v.imageLayer},r.isNormal=function(){return this.type===v.image||this.type===v.html},r.isPoly=function(){return this.isPolygon()||this.isPolyline()},r.isPolyPx=function(){return this.type===v.polygonPx||this.type===v.polylinePx},r.isPolyRad=function(){return this.type===v.polygonRad||this.type===v.polylineRad},r.isPolygon=function(){return this.type===v.polygonPx||this.type===v.polygonRad},r.isPolyline=function(){return this.type===v.polylinePx||this.type===v.polylineRad},r.isSvg=function(){return this.type===v.square||this.type===v.rect||this.type===v.circle||this.type===v.ellipse||this.type===v.path},r.getScale=function(t,s){if(!this.config.scale)return 1;if("function"==typeof this.config.scale)return this.config.scale(t,s);var r=1;if(Array.isArray(this.config.scale.zoom)){var o=this.config.scale.zoom;r*=o[0]+(o[1]-o[0])*i.CONSTANTS.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.longitude)){var n=this.config.scale.longitude,a=e.MathUtils.degToRad(this.psv.prop.hFov)/2,h=Math.abs(i.utils.getShortestArc(this.props.position.longitude,s.longitude));r*=n[1]+(n[0]-n[1])*i.CONSTANTS.EASINGS.outQuad(Math.max(0,(a-h)/a))}return r},r.getListContent=function(){return this.config.listContent?this.config.listContent:this.config.tooltip.content?this.config.tooltip.content:this.config.html?this.config.html:this.id},r.showTooltip=function(t){if(this.props.visible&&this.config.tooltip.content&&this.props.position2D){var e=s({},this.config.tooltip,{data:this});if(this.isPoly())if(t){var r=i.utils.getPosition(this.psv.container);e.top=t.clientY-r.top,e.left=t.clientX-r.left,e.box={width:20,height:20}}else e.top=this.props.position2D.y,e.left=this.props.position2D.x;else e.top=this.props.position2D.y+this.props.height/2,e.left=this.props.position2D.x+this.props.width/2,e.box={width:this.props.width,height:this.props.height};this.tooltip?this.tooltip.move(e):this.tooltip=this.psv.tooltip.create(e)}},r.refreshTooltip=function(){this.tooltip&&this.showTooltip()},r.hideTooltip=function(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)},r.update=function(e){var s,r=t.getType(e,!0);if(void 0!==r&&r!==this.type)throw new i.PSVError("cannot change marker type");i.utils.deepmerge(this.config,e),"string"==typeof this.config.tooltip&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip||(this.config.tooltip={}),this.config.tooltip.trigger||(this.config.tooltip.trigger=l.hover),this.data=this.config.data,this.visible=!1!==this.config.visible,!this.is3d()&&(this.isNormal()?this.$el.className="psv-marker psv-marker--normal":this.$el.setAttribute("class","psv-marker psv-marker--svg"),this.config.className&&i.utils.addClasses(this.$el,this.config.className),this.config.tooltip&&this.$el.classList.add("psv-marker--has-tooltip"),this.config.content&&this.$el.classList.add("psv-marler--has-content"),this.$el.style.opacity=null!=(s=this.config.opacity)?s:1,this.config.style&&i.utils.deepmerge(this.$el.style,this.config.style)),this.props.anchor=i.utils.parsePosition(this.config.anchor),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),this.isNormal()?this.__updateNormal():this.isPoly()?this.__updatePoly():this.isSvg()?this.__updateSvg():this.is3d()&&this.__update3d()},r.__updateNormal=function(){if(!i.utils.isExtendedPosition(this.config))throw new i.PSVError("missing marker position, latitude/longitude or x/y");if(this.config.image&&(!this.config.width||!this.config.height))throw new i.PSVError("missing marker width/height");this.config.width&&this.config.height?(this.props.dynamicSize=!1,this.props.width=this.config.width,this.props.height=this.config.height,this.$el.style.width=this.config.width+"px",this.$el.style.height=this.config.height+"px"):this.props.dynamicSize=!0,this.config.image?(this.props.def=this.config.image,this.$el.style.backgroundImage="url("+this.config.image+")"):this.config.html&&(this.props.def=this.config.html,this.$el.innerHTML=this.config.html),this.$el.style.transformOrigin=100*this.props.anchor.x+"% "+100*this.props.anchor.y+"%",this.props.position=this.psv.dataHelper.cleanPosition(this.config),this.props.positions3D=[this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)]},r.__updateSvg=function(){var t=this;if(!i.utils.isExtendedPosition(this.config))throw new i.PSVError("missing marker position, latitude/longitude or x/y");switch(this.props.dynamicSize=!0,this.type){case v.square:this.props.def={x:0,y:0,width:this.config.square,height:this.config.square};break;case v.rect:Array.isArray(this.config.rect)?this.props.def={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.props.def={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case v.circle:this.props.def={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case v.ellipse:Array.isArray(this.config.ellipse)?this.props.def={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.props.def={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case v.path:this.props.def={d:this.config.path}}i.utils.each(this.props.def,function(e,i){t.$el.setAttributeNS(null,i,e)}),this.config.svgStyle?i.utils.each(this.config.svgStyle,function(e,s){t.$el.setAttributeNS(null,i.utils.dasherize(s),e)}):this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"),this.props.position=this.psv.dataHelper.cleanPosition(this.config),this.props.positions3D=[this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)]},r.__updatePoly=function(){var t=this;this.props.dynamicSize=!0,this.config.svgStyle?(i.utils.each(this.config.svgStyle,function(e,s){t.$el.setAttributeNS(null,i.utils.dasherize(s),e)}),this.isPolyline()&&!this.config.svgStyle.fill&&this.$el.setAttributeNS(null,"fill","none")):this.isPolygon()?this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline()&&(this.$el.setAttributeNS(null,"fill","none"),this.$el.setAttributeNS(null,"stroke","rgb(0,0,0)"));var e=this.config.polygonPx||this.config.polygonRad||this.config.polylinePx||this.config.polylineRad;if(!Array.isArray(e[0]))for(var s=0;s<e.length;s++)e.splice(s,2,[e[s],e[s+1]]);this.isPolyPx()?this.props.def=e.map(function(e){var i=t.psv.dataHelper.textureCoordsToSphericalCoords({x:e[0],y:e[1]});return[i.longitude,i.latitude]}):this.props.def=e.map(function(t){return[i.utils.parseAngle(t[0]),i.utils.parseAngle(t[1],!0)]});var r=this.isPolygon()?function(t){for(var e=[t[0]],s=0,r=1;r<t.length;r++){var o=t[r-1][0]-t[r][0];o>Math.PI?s+=1:o<-Math.PI&&(s-=1),e.push([t[r][0]+2*s*Math.PI,t[r][1]])}var n=e.reduce(function(t,e){return[t[0]+e[0],t[1]+e[1]]});return[i.utils.parseAngle(n[0]/t.length),n[1]/t.length]}(this.props.def):function(t){for(var e=0,s=[],r=0;r<t.length-1;r++){var o=i.utils.greatArcDistance(t[r],t[r+1])*i.CONSTANTS.SPHERE_RADIUS;s.push(o),e+=o}for(var n=0,a=0;a<t.length-1;a++){if(n+s[a]>e/2){var h=(e/2-n)/s[a];return function(t,e,s){var r=t[0],o=t[1],n=e[0],a=e[1],h=i.utils.greatArcDistance(t,e),l=Math.sin((1-s)*h)/Math.sin(h),p=Math.sin(s*h)/Math.sin(h),c=l*Math.cos(o)*Math.cos(r)+p*Math.cos(a)*Math.cos(n),u=l*Math.cos(o)*Math.sin(r)+p*Math.cos(a)*Math.sin(n);return[Math.atan2(u,c),Math.atan2(l*Math.sin(o)+p*Math.sin(a),Math.sqrt(c*c+u*u))]}(t[a],t[a+1],h)}n+=s[a]}return t[Math.round(t.length/2)]}(this.props.def);this.props.position={longitude:r[0],latitude:r[1]},this.props.positions3D=this.props.def.map(function(e){return t.psv.dataHelper.sphericalCoordsToVector3({longitude:e[0],latitude:e[1]})})},r.__update3d=function(){var t=this;if(!this.config.width||!this.config.height)throw new i.PSVError("missing marker width/height");if(this.props.dynamicSize=!1,this.props.width=this.config.width,this.props.height=this.config.height,this.props.position=this.psv.dataHelper.cleanPosition(this.config),this.props.positions3D=[this.psv.dataHelper.sphericalCoordsToVector3(this.props.position)],this.type===v.imageLayer){if(!this.$el){var s,r,o=new e.MeshBasicMaterial({transparent:!0,opacity:null!=(s=this.config.opacity)?s:1,depthTest:!1}),n=new e.PlaneGeometry(1,1),a=new e.Mesh(n,o);(r={})[c]=this,a.userData=r,this.$el=new e.Group().add(a),Object.defineProperty(this.$el,"visible",{enumerable:!0,get:function(){return this.children[0].userData[c].visible},set:function(t){this.children[0].userData[c].visible=t}})}switch(this.props.def!==this.config.imageLayer&&(this.psv.config.requestHeaders&&"function"==typeof this.psv.config.requestHeaders&&this.loader.setRequestHeader(this.psv.config.requestHeaders(this.config.imageLayer)),this.$el.children[0].material.map=this.loader.load(this.config.imageLayer,function(e){e.anisotropy=4,t.psv.needsUpdate()}),this.props.def=this.config.imageLayer),this.$el.children[0].position.set(this.props.anchor.x-.5,this.props.anchor.y-.5,0),this.$el.position.copy(this.props.positions3D[0]),this.config.orientation){case"horizontal":this.$el.lookAt(0,this.$el.position.y,0),this.$el.rotateX(this.props.position.latitude<0?-Math.PI/2:Math.PI/2);break;case"vertical-left":this.$el.lookAt(0,0,0),this.$el.rotateY(-(.4*Math.PI));break;case"vertical-right":this.$el.lookAt(0,0,0),this.$el.rotateY(.4*Math.PI);break;default:this.$el.lookAt(0,0,0)}this.$el.scale.set(this.config.width/100,this.config.height/100,1)}},t.getType=function(t,e){void 0===e&&(e=!1);var s=[];if(i.utils.each(v,function(e){t[e]&&s.push(e)}),0!==s.length||e){if(s.length>1)throw new i.PSVError("multiple marker content, either "+Object.keys(v).join(", "))}else throw new i.PSVError("missing marker content, either "+Object.keys(v).join(", "));return s[0]},t}(),_=function(t){function e(e){var i;return(i=t.call(this,e,"psv-button--hover-scale psv-markers-button",!0)||this).plugin=i.psv.getPlugin("markers"),i.plugin&&(i.plugin.on(h.SHOW_MARKERS,n(i)),i.plugin.on(h.HIDE_MARKERS,n(i)),i.toggleActive(!0)),i.hide(),i}r(e,t);var i=e.prototype;return i.destroy=function(){this.plugin&&(this.plugin.off(h.SHOW_MARKERS,this),this.plugin.off(h.HIDE_MARKERS,this)),t.prototype.destroy.call(this)},i.isSupported=function(){return!!this.plugin},i.handleEvent=function(t){switch(t.type){case h.SHOW_MARKERS:this.toggleActive(!0);break;case h.HIDE_MARKERS:this.toggleActive(!1)}},i.onClick=function(){this.plugin.prop.visible?this.plugin.hide():this.plugin.show()},e}(i.AbstractButton);_.id="markers",_.icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n';var E=function(t){function e(e){var s;return(s=t.call(this,e,"psv-button--hover-scale psv-markers-list-button",!0)||this).plugin=s.psv.getPlugin("markers"),s.plugin&&(s.psv.on(i.CONSTANTS.EVENTS.OPEN_PANEL,n(s)),s.psv.on(i.CONSTANTS.EVENTS.CLOSE_PANEL,n(s))),s.hide(),s}r(e,t);var s=e.prototype;return s.destroy=function(){this.psv.off(i.CONSTANTS.EVENTS.OPEN_PANEL,this),this.psv.off(i.CONSTANTS.EVENTS.CLOSE_PANEL,this),t.prototype.destroy.call(this)},s.isSupported=function(){return!!this.plugin},s.handleEvent=function(t){switch(t.type){case i.CONSTANTS.EVENTS.OPEN_PANEL:this.toggleActive(t.args[0]===g);break;case i.CONSTANTS.EVENTS.CLOSE_PANEL:this.toggleActive(!1)}},s.onClick=function(){this.plugin.toggleMarkersList()},e}(i.AbstractButton);E.id="markersList",E.icon=a,i.DEFAULTS.lang[_.id]="Markers",i.DEFAULTS.lang[E.id]="Markers list",i.registerButton(_,"caption:left"),i.registerButton(E,"caption:left");var y=function(t){function o(e,i){var r;return(r=t.call(this,e)||this).markers={},r.prop={visible:!0,currentMarker:null,hoveringMarker:null,stopObserver:null},r.config=s({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm"},i),r.container=document.createElement("div"),r.container.className="psv-markers",r.container.style.cursor=r.psv.config.mousemove?"move":"default",r.svgContainer=document.createElementNS(p,"svg"),r.svgContainer.setAttribute("class","psv-markers-svg-container"),r.container.appendChild(r.svgContainer),r.container.addEventListener("mouseenter",n(r),!0),r.container.addEventListener("mouseleave",n(r),!0),r.container.addEventListener("mousemove",n(r),!0),r.container.addEventListener("contextmenu",n(r)),r}r(o,t);var v=o.prototype;return v.init=function(){var e=this;t.prototype.init.call(this),this.psv.container.appendChild(this.container),this.psv.on(i.CONSTANTS.EVENTS.CLICK,this),this.psv.on(i.CONSTANTS.EVENTS.DOUBLE_CLICK,this),this.psv.on(i.CONSTANTS.EVENTS.RENDER,this),this.psv.on(i.CONSTANTS.EVENTS.CONFIG_CHANGED,this),this.psv.once(i.CONSTANTS.EVENTS.READY,function(){e.config.markers&&(e.setMarkers(e.config.markers),delete e.config.markers)})},v.destroy=function(){var e,s;this.clearMarkers(!1),null==(e=(s=this.prop).stopObserver)||e.call(s),this.psv.off(i.CONSTANTS.EVENTS.CLICK,this),this.psv.off(i.CONSTANTS.EVENTS.DOUBLE_CLICK,this),this.psv.off(i.CONSTANTS.EVENTS.RENDER,this),this.psv.off(i.CONSTANTS.EVENTS.CONFIG_CHANGED,this),this.psv.container.removeChild(this.container),delete this.svgContainer,delete this.markers,delete this.container,t.prototype.destroy.call(this)},v.handleEvent=function(t){switch(t.type){case"mouseenter":this.__onMouseEnter(t,this.__getTargetMarker(t.target));break;case"mouseleave":this.__onMouseLeave(t,this.__getTargetMarker(t.target));break;case"mousemove":this.__onMouseMove(t,this.__getTargetMarker(t.target));break;case"contextmenu":t.preventDefault();break;case i.CONSTANTS.EVENTS.CLICK:this.__onClick(t,t.args[0],!1);break;case i.CONSTANTS.EVENTS.DOUBLE_CLICK:this.__onClick(t,t.args[0],!0);break;case i.CONSTANTS.EVENTS.RENDER:this.renderMarkers();break;case i.CONSTANTS.OBJECT_EVENTS.ENTER_OBJECT:this.__onMouseEnter(t.detail.originalEvent,t.detail.data);break;case i.CONSTANTS.OBJECT_EVENTS.LEAVE_OBJECT:this.__onMouseLeave(t.detail.originalEvent,t.detail.data);break;case i.CONSTANTS.OBJECT_EVENTS.HOVER_OBJECT:this.__onMouseMove(t.detail.originalEvent,t.detail.data);break;case i.CONSTANTS.EVENTS.CONFIG_CHANGED:this.container.style.cursor=this.psv.config.mousemove?"move":"default"}},v.show=function(){this.prop.visible=!0,this.renderMarkers(),this.trigger(h.SHOW_MARKERS)},v.hide=function(){this.prop.visible=!1,this.renderMarkers(),this.trigger(h.HIDE_MARKERS)},v.toggleAllTooltips=function(){this.prop.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()},v.showAllTooltips=function(){this.prop.showAllTooltips=!0,i.utils.each(this.markers,function(t){t.props.staticTooltip=!0,t.showTooltip()})},v.hideAllTooltips=function(){this.prop.showAllTooltips=!1,i.utils.each(this.markers,function(t){t.props.staticTooltip=!1,t.hideTooltip()})},v.getNbMarkers=function(){return Object.keys(this.markers).length},v.getMarkers=function(){return Object.values(this.markers)},v.addMarker=function(t,e){if(void 0===e&&(e=!0),this.markers[t.id])throw new i.PSVError('marker "'+t.id+'" already exists');var s=new d(t,this.psv);return s.isNormal()?this.container.appendChild(s.$el):s.isPoly()||s.isSvg()?this.svgContainer.appendChild(s.$el):s.is3d()&&this.psv.renderer.scene.add(s.$el),this.markers[s.id]=s,e&&(this.renderMarkers(),this.__refreshUi(),this.__checkObjectsObserver(),this.trigger(h.SET_MARKERS,this.getMarkers())),s},v.getMarker=function(t){var e="object"==typeof t?t.id:t;if(!this.markers[e])throw new i.PSVError('cannot find marker "'+e+'"');return this.markers[e]},v.getCurrentMarker=function(){return this.prop.currentMarker},v.updateMarker=function(t,e){void 0===e&&(e=!0);var i=this.getMarker(t.id);return i.update(t),e&&(this.renderMarkers(),this.__refreshUi(),i.is3d()&&this.psv.needsUpdate(),this.trigger(h.SET_MARKERS,this.getMarkers())),i},v.removeMarker=function(t,e){void 0===e&&(e=!0);var i=this.getMarker(t);i.isNormal()?this.container.removeChild(i.$el):i.isPoly()||i.isSvg()?this.svgContainer.removeChild(i.$el):i.is3d()&&(this.psv.renderer.scene.remove(i.$el),this.psv.needsUpdate()),this.prop.hoveringMarker===i&&(this.prop.hoveringMarker=null),this.prop.currentMarker===i&&(this.prop.currentMarker=null),i.hideTooltip(),i.destroy(),delete this.markers[i.id],e&&(this.__refreshUi(),this.__checkObjectsObserver(),this.trigger(h.SET_MARKERS,this.getMarkers()))},v.removeMarkers=function(t,e){var i=this;void 0===e&&(e=!0),t.forEach(function(t){return i.removeMarker(t,!1)}),e&&(this.__refreshUi(),this.__checkObjectsObserver(),this.trigger(h.SET_MARKERS,this.getMarkers()))},v.setMarkers=function(t,e){var s=this;void 0===e&&(e=!0),this.clearMarkers(!1),i.utils.each(t,function(t){return s.addMarker(t,!1)}),e&&(this.renderMarkers(),this.__refreshUi(),this.__checkObjectsObserver(),this.trigger(h.SET_MARKERS,this.getMarkers()))},v.clearMarkers=function(t){var e=this;void 0===t&&(t=!0),i.utils.each(this.markers,function(t){return e.removeMarker(t,!1)}),t&&(this.renderMarkers(),this.__refreshUi(),this.__checkObjectsObserver(),this.trigger(h.SET_MARKERS,this.getMarkers()))},v.gotoMarker=function(t,e){var i=this;void 0===e&&(e=this.config.gotoMarkerSpeed);var r=this.getMarker(t);return this.psv.animate(s({},r.props.position,{zoom:r.config.zoomLvl,speed:e})).then(function(){i.trigger(h.GOTO_MARKER_DONE,r)})},v.hideMarker=function(t){this.toggleMarker(t,!1)},v.showMarker=function(t){this.toggleMarker(t,!0)},v.showMarkerTooltip=function(t){var e=this.getMarker(t);e.props.staticTooltip=!0,e.showTooltip()},v.hideMarkerTooltip=function(t){var e=this.getMarker(t);e.props.staticTooltip=!1,e.hideTooltip()},v.toggleMarker=function(t,e){void 0===e&&(e=null);var i=this.getMarker(t);i.visible=null===e?!i.visible:e,i.is3d()?this.psv.needsUpdate():this.renderMarkers()},v.showMarkerPanel=function(t){var e,i=this.getMarker(t);null!=i&&null!=(e=i.config)&&e.content?this.psv.panel.show({id:u,content:i.config.content}):this.psv.panel.hide(u)},v.toggleMarkersList=function(){this.psv.panel.prop.contentId===g?this.hideMarkersList():this.showMarkersList()},v.showMarkersList=function(){var t,e=this,s=[];i.utils.each(this.markers,function(t){t.visible&&!t.config.hideList&&s.push(t)}),s=this.change(h.RENDER_MARKERS_LIST,s),this.psv.panel.show({id:g,content:(t=s,'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">'+a+" "+this.psv.config.lang[_.id]+'</h1>\n  <ul class="psv-panel-menu-list">\n    '+t.map(function(t){return"\n    <li data-"+f+'="'+t.config.id+'" class="psv-panel-menu-item" tabindex="0">\n      '+("image"===t.type?'<span class="psv-panel-menu-item-icon"><img src="'+t.config.image+'"/></span>':"")+'\n      <span class="psv-panel-menu-item-label">'+t.getListContent()+"</span>\n    </li>\n    "}).join("")+"\n  </ul>\n</div>\n"),noMargin:!0,clickHandler:function(t){var s=t.target?i.utils.getClosest(t.target,"li"):void 0,r=s?s.dataset[c]:void 0;if(r){var o=e.getMarker(r);e.trigger(h.SELECT_MARKER_LIST,o),e.gotoMarker(o),e.hideMarkersList()}}})},v.hideMarkersList=function(){this.psv.panel.hide(g)},v.renderMarkers=function(){var t=this,e=this.psv.getZoomLevel(),s=this.psv.getPosition();i.utils.each(this.markers,function(r){var o=t.prop.visible&&r.visible,n=!1,a=null;if(o&&r.is3d())a=t.__getMarkerPosition(r),o=t.__isMarkerVisible(r,a);else if(o&&r.isPoly()){var p=t.__getPolyPositions(r);if(o=p.length>(r.isPolygon()?2:1)){a=t.__getMarkerPosition(r);var c=p.map(function(t){return t.x-a.x+","+(t.y-a.y)}).join(" ");r.$el.setAttributeNS(null,"points",c),r.$el.setAttributeNS(null,"transform","translate("+a.x+" "+a.y+")")}}else if(o&&(r.props.dynamicSize&&t.__updateMarkerSize(r),a=t.__getMarkerPosition(r),o=t.__isMarkerVisible(r,a))){var u=r.getScale(e,s);if(r.isSvg()){var g=a.x+r.props.width*r.props.anchor.x*(1-u),f=a.y+r.props.height*r.props.anchor.y*(1-u);r.$el.setAttributeNS(null,"transform","translate("+g+", "+f+") scale("+u+", "+u+")")}else r.$el.style.transform="translate3D("+a.x+"px, "+a.y+"px, 0px) scale("+u+", "+u+")"}n=r.props.visible!==o,r.props.visible=o,r.props.position2D=o?a:null,r.is3d()||i.utils.toggleClass(r.$el,"psv-marker--visible",o),o?r.props.staticTooltip?r.showTooltip():r.config.tooltip.trigger!==l.click&&(r!==t.prop.hoveringMarker||r.isPoly())?r!==t.prop.hoveringMarker&&r.hideTooltip():r.refreshTooltip():r.hideTooltip(),n&&t.trigger(h.MARKER_VISIBILITY,r,o)})},v.__isMarkerVisible=function(t,e){return t.props.positions3D[0].dot(this.psv.prop.direction)>0&&e.x+t.props.width>=0&&e.x-t.props.width<=this.psv.prop.size.width&&e.y+t.props.height>=0&&e.y-t.props.height<=this.psv.prop.size.height},v.__updateMarkerSize=function(t){t.$el.classList.add("psv-marker--transparent"),t.isSvg()?(e=t.$el.getAttributeNS(null,"transform"),t.$el.removeAttributeNS(null,"transform")):(e=t.$el.style.transform,t.$el.style.transform="");var e,i=t.$el.getBoundingClientRect();t.props.width=i.width,t.props.height=i.height,t.$el.classList.remove("psv-marker--transparent"),e&&(t.isSvg()?t.$el.setAttributeNS(null,"transform",e):t.$el.style.transform=e),t.props.dynamicSize=!1},v.__getMarkerPosition=function(t){if(t.isPoly())return this.psv.dataHelper.sphericalCoordsToViewerCoords(t.props.position);var e=this.psv.dataHelper.vector3ToViewerCoords(t.props.positions3D[0]);return e.x-=t.props.width*t.props.anchor.x,e.y-=t.props.height*t.props.anchor.y,e},v.__getPolyPositions=function(t){var e=this,i=t.props.positions3D.length,s=t.props.positions3D.map(function(t){return{vector:t,visible:t.dot(e.psv.prop.direction)>0}}),r=[];return s.forEach(function(t,e){t.visible||[0===e?s[i-1]:s[e-1],e===i-1?s[0]:s[e+1]].forEach(function(i){i.visible&&r.push({visible:i,invisible:t,index:e})})}),r.reverse().forEach(function(t){s.splice(t.index,0,{vector:e.__getPolyIntermediaryPoint(t.visible.vector,t.invisible.vector),visible:!0})}),s.filter(function(t){return t.visible}).map(function(t){return e.psv.dataHelper.vector3ToViewerCoords(t.vector)})},v.__getPolyIntermediaryPoint=function(t,s){var r=this.psv.prop.direction.clone().normalize(),o=new e.Vector3().crossVectors(t,s).normalize(),n=new e.Vector3().crossVectors(o,t).normalize(),a=t.clone().multiplyScalar(-r.dot(n)),h=n.clone().multiplyScalar(r.dot(t)),l=new e.Vector3().addVectors(a,h).normalize(),p=new e.Vector3().crossVectors(l,r);return l.applyAxisAngle(p,.01).multiplyScalar(i.CONSTANTS.SPHERE_RADIUS)},v.__getTargetMarker=function(t,e){void 0===e&&(e=!1);var s=e?i.utils.getClosest(t,".psv-marker"):t;return s?s[c]:void 0},v.__targetOnTooltip=function(t,e){return!!t&&!!e&&i.utils.hasParent(t,e.container)},v.__onMouseEnter=function(t,e){e&&!e.isPoly()&&(this.prop.hoveringMarker=e,this.trigger(h.OVER_MARKER,e),e.props.staticTooltip||e.config.tooltip.trigger!==l.hover||e.showTooltip(t))},v.__onMouseLeave=function(t,e){e&&!(e.isPoly()&&this.__targetOnTooltip(t.relatedTarget,e.tooltip))&&(this.trigger(h.LEAVE_MARKER,e),this.prop.hoveringMarker=null,e.props.staticTooltip||e.config.tooltip.trigger!==l.hover||e.hideTooltip())},v.__onMouseMove=function(t,e){var i,s;null!=e&&e.isPoly()?s=e:this.prop.hoveringMarker&&this.__targetOnTooltip(t.target,this.prop.hoveringMarker.tooltip)&&(s=this.prop.hoveringMarker),s?(this.prop.hoveringMarker||(this.trigger(h.OVER_MARKER,s),this.prop.hoveringMarker=s),s.props.staticTooltip||s.showTooltip(t)):null!=(i=this.prop.hoveringMarker)&&i.isPoly()&&(this.trigger(h.LEAVE_MARKER,this.prop.hoveringMarker),this.prop.hoveringMarker.props.staticTooltip||this.prop.hoveringMarker.hideTooltip(),this.prop.hoveringMarker=null)},v.__onClick=function(t,e,i){var s,r=null==(s=e.objects.find(function(t){return t.userData[c]}))?void 0:s.userData[c];r||(r=this.__getTargetMarker(e.target,!0)),this.prop.currentMarker&&this.prop.currentMarker!==r&&(this.trigger(h.UNSELECT_MARKER,this.prop.currentMarker),this.psv.panel.hide(u),this.prop.showAllTooltips||this.prop.currentMarker.config.tooltip.trigger!==l.click||this.hideMarkerTooltip(this.prop.currentMarker),this.prop.currentMarker=null),r&&(this.prop.currentMarker=r,this.trigger(h.SELECT_MARKER,r,{dblclick:i,rightclick:e.rightclick}),this.config.clickEventOnMarker?e.marker=r:t.stopPropagation(),this.markers[r.id]&&(r.config.tooltip.trigger===l.click?r.tooltip?this.hideMarkerTooltip(r):this.showMarkerTooltip(r):this.showMarkerPanel(r.id)))},v.__refreshUi=function(){var t,e,i=Object.values(this.markers).filter(function(t){return!t.config.hideList}).length;0===i?this.psv.panel.isVisible(g)?this.psv.panel.hide():this.psv.panel.isVisible(u)&&this.psv.panel.hide():this.psv.panel.isVisible(g)?this.showMarkersList():this.psv.panel.isVisible(u)&&(this.prop.currentMarker?this.showMarkerPanel(this.prop.currentMarker):this.psv.panel.hide()),null==(t=this.psv.navbar.getButton(_.id,!1))||t.toggle(i>0),null==(e=this.psv.navbar.getButton(E.id,!1))||e.toggle(i>0)},v.__checkObjectsObserver=function(){var t=Object.values(this.markers).some(function(t){return t.is3d()});!t&&this.prop.stopObserver?(this.prop.stopObserver(),this.prop.stopObserver=null):t&&!this.prop.stopObserver&&(this.prop.stopObserver=this.psv.observeObjects(c,this))},o}(i.AbstractPlugin);y.id="markers",y.EVENTS=h,t.EVENTS=h,t.MarkersPlugin=y,Object.defineProperty(t,"__esModule",{value:!0})})(e,i(4433),i(8947))},2882:function(t,e,i){(function(t,e,i){"use strict";function s(){return(s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}function o(t,e){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var n={GYROSCOPE_UPDATED:"gyroscope-updated"},a=new e.Vector3(0,0,1),h=new e.Euler,l=new e.Quaternion,p=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),c=function(t){!1===window.isSecureContext&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");var i=this,s=new e.Quaternion;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var r=function(t){i.deviceOrientation=t},o=function(){i.screenOrientation=window.orientation||0},n=function(t,e,i,s,r){h.set(i,e,-s,"YXZ"),t.setFromEuler(h),t.multiply(p),t.multiply(l.setFromAxisAngle(a,-r))};this.connect=function(){o(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then(function(t){"granted"==t&&(window.addEventListener("orientationchange",o),window.addEventListener("deviceorientation",r))}).catch(function(t){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",t)}):(window.addEventListener("orientationchange",o),window.addEventListener("deviceorientation",r)),i.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",o),window.removeEventListener("deviceorientation",r),i.enabled=!1},this.update=function(){if(!1!==i.enabled){var t=i.deviceOrientation;if(t){var r=t.alpha?e.MathUtils.degToRad(t.alpha)+i.alphaOffset:0,o=t.beta?e.MathUtils.degToRad(t.beta):0,a=t.gamma?e.MathUtils.degToRad(t.gamma):0,h=i.screenOrientation?e.MathUtils.degToRad(i.screenOrientation):0;n(i.object.quaternion,r,o,a,h),8*(1-s.dot(i.object.quaternion))>1e-6&&s.copy(i.object.quaternion)}}},this.dispose=function(){i.disconnect()},this.connect()},u=function(t){function e(e){var i;return(i=t.call(this,e,"psv-button--hover-scale psv-gyroscope-button",!0)||this).plugin=i.psv.getPlugin("gyroscope"),i.plugin&&i.plugin.on(n.GYROSCOPE_UPDATED,function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}r(e,t);var i=e.prototype;return i.destroy=function(){this.plugin&&this.plugin.off(n.GYROSCOPE_UPDATED,this),delete this.plugin,t.prototype.destroy.call(this)},i.isSupported=function(){return!!this.plugin&&{initial:!1,promise:this.plugin.prop.isSupported}},i.handleEvent=function(t){t.type===n.GYROSCOPE_UPDATED&&this.toggleActive(t.args[0])},i.onClick=function(){this.plugin.toggle()},e}(i.AbstractButton);u.id="gyroscope",u.icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/><path fill="currentColor" d="M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/>\x3c!--Created by iconoci from the Noun Project--\x3e</svg>\n',i.DEFAULTS.lang[u.id]="Gyroscope",i.registerButton(u,"caption:right");var g=new e.Vector3,f=function(t){function o(e,i){var r;return(r=t.call(this,e)||this).prop={isSupported:r.__checkSupport(),alphaOffset:0,enabled:!1,config_moveInertia:!0},r.config=s({touchmove:!0,absolutePosition:!1,moveMode:"smooth"},i),r.controls=null,r}r(o,t);var a=o.prototype;return a.init=function(){t.prototype.init.call(this),this.psv.on(i.CONSTANTS.EVENTS.STOP_ALL,this),this.psv.on(i.CONSTANTS.EVENTS.BEFORE_ROTATE,this),this.psv.on(i.CONSTANTS.EVENTS.BEFORE_RENDER,this)},a.destroy=function(){this.psv.off(i.CONSTANTS.EVENTS.STOP_ALL,this),this.psv.off(i.CONSTANTS.EVENTS.BEFORE_ROTATE,this),this.psv.off(i.CONSTANTS.EVENTS.BEFORE_RENDER,this),this.stop(),delete this.controls,t.prototype.destroy.call(this)},a.handleEvent=function(t){switch(t.type){case i.CONSTANTS.EVENTS.STOP_ALL:this.stop();break;case i.CONSTANTS.EVENTS.BEFORE_RENDER:this.__onBeforeRender();break;case i.CONSTANTS.EVENTS.BEFORE_ROTATE:this.__onBeforeRotate(t)}},a.isEnabled=function(){return this.prop.enabled},a.start=function(){var t=this;return this.prop.isSupported.then(function(e){return e?t.__requestPermission():(i.utils.logWarn("gyroscope not available"),Promise.reject())}).then(function(t){return t?Promise.resolve():(i.utils.logWarn("gyroscope not allowed"),Promise.reject())}).then(function(){t.psv.__stopAll(),t.prop.config_moveInertia=t.psv.config.moveInertia,t.psv.config.moveInertia=!1,t.controls?t.controls.connect():t.controls=new c(new e.Object3D),t.controls.deviceOrientation=null,t.controls.screenOrientation=0,t.controls.alphaOffset=0,t.prop.alphaOffset=t.config.absolutePosition?0:null,t.prop.enabled=!0,t.trigger(n.GYROSCOPE_UPDATED,!0)})},a.stop=function(){this.isEnabled()&&(this.controls.disconnect(),this.prop.enabled=!1,this.psv.config.moveInertia=this.prop.config_moveInertia,this.trigger(n.GYROSCOPE_UPDATED,!1),this.psv.resetIdleTimer())},a.toggle=function(){this.isEnabled()?this.stop():this.start()},a.__onBeforeRender=function(){if(this.isEnabled()&&this.controls.deviceOrientation){var t=this.psv.getPosition();if(null===this.prop.alphaOffset){this.controls.update(),this.controls.object.getWorldDirection(g);var e=this.psv.dataHelper.vector3ToSphericalCoords(g);this.prop.alphaOffset=e.longitude-t.longitude}else{this.controls.alphaOffset=this.prop.alphaOffset,this.controls.update(),this.controls.object.getWorldDirection(g);var s=this.psv.dataHelper.vector3ToSphericalCoords(g),r={longitude:s.longitude,latitude:-s.latitude},o="smooth"===this.config.moveMode?3:10;this.psv.dynamics.position.goto(r,.01>i.utils.getAngle(t,r)?1:o)}}},a.__onBeforeRotate=function(t){this.isEnabled()&&(t.preventDefault(),this.config.touchmove&&(this.prop.alphaOffset-=t.args[0].longitude-this.psv.getPosition().longitude))},a.__checkSupport=function(){return"DeviceMotionEvent"in window&&"function"==typeof DeviceMotionEvent.requestPermission?Promise.resolve(!0):"DeviceOrientationEvent"in window?new Promise(function(t){var e=function e(i){t(i&&null!==i.alpha&&!isNaN(i.alpha)),window.removeEventListener("deviceorientation",e)};window.addEventListener("deviceorientation",e,!1),setTimeout(e,1e4)}):Promise.resolve(!1)},a.__requestPermission=function(){return"DeviceMotionEvent"in window&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){return"granted"===t}).catch(function(){return!1}):Promise.resolve(!0)},o}(i.AbstractPlugin);f.id="gyroscope",f.EVENTS=n,t.EVENTS=n,t.GyroscopePlugin=f,Object.defineProperty(t,"__esModule",{value:!0})})(e,i(4433),i(8947))},3649:()=>{},4892:()=>{},5501:function(t,e){(function(t){"use strict";var e=function(){return!0},i=function(){return!1},s=function(){function t(t,e,s){Object.defineProperties(this,{target:{get:function(){return t},set:function(){},enumerable:!0},type:{get:function(){return e},set:function(){},enumerable:!0},args:{get:function(){return s},set:function(){},enumerable:!0}}),this.isDefaultPrevented=i,this.isPropagationStopped=i}var s=t.prototype;return s.preventDefault=function(){this.isDefaultPrevented=e},s.stopPropagation=function(){this.isPropagationStopped=e},t}(),r=function(){function t(){}var e=t.prototype;return e.on=function(t,e){var i=this;if(this.__events=this.__events||{},"object"==typeof t)for(var s in t)t.hasOwnProperty(s)&&(this.__events[s]=this.__events[s]||[],this.__events[s].push(t[s]));else t.split(" ").forEach(function(t){i.__events[t]=i.__events[t]||[],i.__events[t].push(e)});return this},e.off=function(t,e){var i=this;if("object"==typeof t){for(var s in t)if(t.hasOwnProperty(s)){if(this.__events&&s in this.__events){var r=this.__events[s].indexOf(t[s]);-1!==r&&this.__events[s].splice(r,1)}if(this.__once&&s in this.__once){var o=this.__once[s].indexOf(t[s]);-1!==o&&this.__once[s].splice(o,1)}}}else t?t.split(" ").forEach(function(t){if(i.__events&&t in i.__events)if(e){var s=i.__events[t].indexOf(e);-1!==s&&i.__events[t].splice(s,1)}else i.__events[t].length=0;if(i.__once&&t in i.__once)if(e){var r=i.__once[t].indexOf(e);-1!==r&&i.__once[t].splice(r,1)}else i.__once[t].length=0}):(this.__events={},this.__once={});return this},e.once=function(t,e){var i=this;if(this.__once=this.__once||{},"object"==typeof t)for(var s in t)t.hasOwnProperty(s)&&(this.__once[s]=this.__once[s]||[],this.__once[s].push(t[s]));else t.split(" ").forEach(function(t){i.__once[t]=i.__once[t]||[],i.__once[t].push(e)});return this},e.trigger=function(t){var e=Array.prototype.slice.call(arguments,1),i=new s(this,t,e);if(this.__events&&t in this.__events)for(var r=0,o=this.__events[t].length;r<o;r++){var n=this.__events[t][r];if("object"==typeof n?n.handleEvent(i):n.call.apply(n,[this,i].concat(e)),i.isPropagationStopped())break}if(this.__once&&t in this.__once){for(var a=0,h=this.__once[t].length;a<h;a++){var l=this.__once[t][a];if("object"==typeof l?l.handleEvent(i):l.call.apply(l,[this,i].concat(e)),i.isPropagationStopped())break}delete this.__once[t]}return i},e.change=function(t,e){var i=Array.prototype.slice.call(arguments,2),r=new s(this,t,i);if(r.value=e,this.__events&&t in this.__events)for(var o=0,n=this.__events[t].length;o<n;o++){var a=this.__events[t][o];if("object"==typeof a?r.value=a.handleEvent(r):r.value=a.call.apply(a,[this,r,r.value].concat(i)),r.isPropagationStopped())break}return r.value},t}(),o={EventEmitter:r,Event:s,mixin:function(t){return t="function"==typeof t?t.prototype:t,["on","off","once","trigger","change"].forEach(function(e){t[e]=r.prototype[e]}),t}},n=o.EventEmitter,a=o.Event,h=o.mixin;t.Event=a,t.EventEmitter=n,t.default=o,t.mixin=h,Object.defineProperty(t,"__esModule",{value:!0})})(e)}}]);