"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[595],{7481:(e,t,r)=>{r.d(t,{dj:()=>p});var o=r(2115);let a=0,s=new Map,n=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],u={toasts:[]};function c(e){u=i(u,e),l.forEach(e=>{e(u)})}function d(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),o=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||o()}}}),{id:r,dismiss:o,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function p(){let[e,t]=o.useState(u);return o.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7595:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var o=r(5155),a=r(2115),s=r(8947),n=r(560),i=r(2882);r(3649),r(4892);var l=r(7481);let u=(0,a.forwardRef)((e,t)=>{let{imageSrc:r,markers:u}=e,c=(0,a.useRef)(null),d=(0,a.useRef)(null),{toast:p}=(0,l.dj)(),[f,S]=(0,a.useState)(null);return(0,a.useEffect)(()=>{"function"==typeof r?r().then(e=>{S(e.default)}):S(r)},[r]),(0,a.useImperativeHandle)(t,()=>({toggleGyroscope(){var e;let t=null==(e=d.current)?void 0:e.getPlugin(i.GyroscopePlugin);t&&(t.isStarted?t.stop():t.start().catch(()=>{p({variant:"destructive",title:"Gyroscope Error",description:"Could not activate motion controls. Please ensure your device supports it and permissions are granted."})}))}})),(0,a.useEffect)(()=>{let e=c.current;if(!f)return;let t=setTimeout(()=>{if(e&&!d.current)try{d.current=new s.Viewer({container:e,panorama:f,loadingTxt:"Loading...",navbar:["zoom","fullscreen","caption"],defaultZoomLvl:30,plugins:[[n.MarkersPlugin,{}],[i.GyroscopePlugin,{}]]});let t=d.current.getPlugin(n.MarkersPlugin);if(t&&u)for(let e of(t.clearMarkers(),u))t.addMarker(e);d.current.on("click",(e,t)=>{console.log("User clicked at: latitude ".concat(t.latitude,", longitude ").concat(t.longitude))}),d.current.on("error",e=>{console.error("Photo Sphere Viewer error:",e),p({variant:"destructive",title:"Viewer Error",description:"Failed to render 360 image."})})}catch(e){console.error("Photo Sphere Viewer initialization error:",e),p({variant:"destructive",title:"Viewer Error",description:"The 360-degree viewer failed to start."})}},150);return()=>{if(clearTimeout(t),d.current)try{d.current.destroy()}catch(e){console.warn("Photo Sphere Viewer cleanup error:",e)}finally{d.current=null}}},[f,u,p]),(0,o.jsx)("div",{ref:c,className:"w-full h-full"})});u.displayName="PhotoViewer";let c=u}}]);